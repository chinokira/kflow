<!-- État de chargement -->
<div class="loading-container" *ngIf="isLoading">
  <mat-spinner diameter="40"></mat-spinner>
  <p>Chargement des données...</p>
</div>

<!-- Message d'erreur -->
<div class="error-message" *ngIf="error">
  <p>{{ error }}</p>
</div>

<!-- Contenu principal -->
<div class="competition-detail" *ngIf="!isLoading && !error">
  <!-- En-tête de la compétition -->
  <div class="competition-header" *ngIf="competition">
    <h1>Compétition de {{ competition.place }}</h1>
    <div class="competition-info">
      <p><strong>Niveau:</strong> {{ competition.level }}</p>
      <p><strong>Date:</strong> {{ competition.startDate | date:'dd/MM/yyyy' }} - {{ competition.endDate | date:'dd/MM/yyyy' }}</p>
    </div>
  </div>

  <!-- Onglets pour les catégories -->
  <mat-tab-group *ngIf="categories.length">
    <mat-tab *ngFor="let categorie of categories" [label]="categorie.name">
      <div class="tab-content">
        <!-- Tableau des participants -->
        <div class="results-table-container">
          <table mat-table [dataSource]="categorie.participants" class="results-table">
            <!-- Position -->
            <ng-container matColumnDef="position">
              <th mat-header-cell *matHeaderCellDef>Pos.</th>
              <td mat-cell *matCellDef="let participant; let i = index">{{ i + 1 }}</td>
            </ng-container>

            <!-- Dossard -->
            <ng-container matColumnDef="bibNb">
              <th mat-header-cell *matHeaderCellDef>Dossard</th>
              <td mat-cell *matCellDef="let participant">{{ participant.bibNb }}</td>
            </ng-container>

            <!-- Nom -->
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>Participant</th>
              <td mat-cell *matCellDef="let participant">{{ participant.name }}</td>
            </ng-container>

            <!-- Club -->
            <ng-container matColumnDef="club">
              <th mat-header-cell *matHeaderCellDef>Club</th>
              <td mat-cell *matCellDef="let participant">{{ participant.club }}</td>
            </ng-container>

            <!-- Runs -->
            <ng-container matColumnDef="runs">
              <th mat-header-cell *matHeaderCellDef>Runs</th>
              <td mat-cell *matCellDef="let participant">{{ getParticipantRuns(participant) }}</td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>

  <!-- Message si aucune catégorie -->
  <div class="no-data-message" *ngIf="competition && categories.length === 0">
    <p>Aucune catégorie trouvée pour cette compétition</p>
  </div>
</div> 